<html>
    <head>
        <meta charset="utf-8">
        <meta name="description" content="Página de recuperação de senha do MyHealth. Um site para contorlar as suas vacinas" >
        <title>MyHealth - Entrar</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Averia+Libre&display=swap" rel="stylesheet">
        <link rel="icon" type="image/x-icon" href="img/favicon.ico">
        <link rel="stylesheet" href="./css/global.css">
        <link rel="stylesheet" href="./css/entrar.css">
        <script src="./javascript/entrar.js"></script>
    </head>
    <body>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
            import { getAuth } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";
            import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries
          
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
                apiKey: "AIzaSyBBRZZFQlmx-XAu2lG_NqLymPA1rammWB0",
                authDomain: "myhealth-d1dcc.firebaseapp.com",
                projectId: "myhealth-d1dcc",
                storageBucket: "myhealth-d1dcc.appspot.com",
                messagingSenderId: "956659268017",
                appId: "1:956659268017:web:034ca0be6970e04c332590",
                measurementId: "G-YRSQ1PBKGB"
                };
          
            var app = initializeApp(firebaseConfig);

            const auth = getAuth(app);

            const entrarBtn = document.getElementById("entrarBtn");
            entrarBtn.addEventListener("click", entrar);


            function entrar(){
                const senha = document.getElementById("senha").value;
                const email = document.getElementById("email").value;

                    signInWithEmailAndPassword(auth, email, senha)
                .then((userCredential) => {
                    const user = userCredential.user
                    localStorage.setItem("usuarioLogado", '[{"uid":"'+user.uid+'"}]');
                    window.location.href = "home.html";
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Login failed:", errorCode, errorMessage);
                    document.getElementById("erro").className = "erro";
                });
            }
        </script>
        <header>
            <a id="titulo" href="/"><img id="logo" src="./img/logo.png"></img>MyHealth</a>
        </header>
        <main>
            <form action="" class="formLongo">
                <div class="">
                    <label class="formLongoLabel" for="email">E-mail</label>
                    <input class="formLongoInput" type="email" id="email" name="email">
                    <label class="formLongoLabel" for="senha">Senha</label>
                    <input class="formLongoInput" type="password" id="senha" name="senha">
                    <p class="escondido" id="erro">E-mail e/ou senha inválidos.</p>
                </div>
                <div  id="entrarBtn" class="botao save">Entrar</div>
            </form>
            <a href="recuperarSenha.html" id="esqueci">Esqueci minha senha</a>
        </main>
    </body>
</html>